<!DOCTYPE html>
<html>
<head>
  <title>Expenditure Records</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <nav class="navbar navbar-expand navbar-light bg-light mb-4">
    <div class="container-fluid">
      <span class="navbar-brand">
        <img src="/logo.png" alt="Logo" style="height:32px;width:auto;margin-right:8px;vertical-align:middle;">
        Income & Expenditure Tracker
      </span>
      <div class="d-flex">
        <a href="/report" class="btn btn-outline-primary me-2">Report</a>
        <a href="/logout" class="btn btn-outline-danger">Logout</a>
      </div>
    </div>
  </nav>
  <div class="container mt-4">
    <h1>Expenditure Records</h1>
    <form action="/expenditure" method="POST" class="mb-4">
      <input type="hidden" name="type" value="expenditure">
      <div class="mb-3">
        <label for="source" class="form-label">Source</label>
        <select name="source" id="source" class="form-select" required>
          <option value="donations">Donations</option>
          <option value="literature">Literature</option>
          <option value="district welfare">District Welfare</option>
          <option value="15% LDF to welfare">15% LDF to welfare</option>

          <option value="sunday recurrent expenditure">Sunday Recurrent Expenditure</option>
          <option value="other_expenditure">Other</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <input type="text" name="description" id="description" class="form-control" >
      </div>
      <div class="mb-3">
        <label for="amount" class="form-label">Amount</label>
        <input type="number" name="amount" id="amount" class="form-control" step="0.01" required>
      </div>
      <div class="mb-3">
        <label for="date" class="form-label">Date</label>
        <input type="date" name="date" id="date" class="form-control" required>
      </div>
      <button type="submit" class="btn btn-danger">Add Expenditure</button>
      <a href="/" class="btn btn-secondary">Back to Summary</a>
    </form>
    <h3>All Expenditure Entries</h3>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Date</th>
          <th>Source</th>
          <th>Description</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% function formatDate(dateStr) {
          if (!dateStr) return '';
          const d = new Date(dateStr);
          const day = String(d.getDate()).padStart(2, '0');
          const month = String(d.getMonth() + 1).padStart(2, '0');
          const year = d.getFullYear();
          return `${day}/${month}/${year}`;
        } %>
        <% records.forEach(function(record) { %>
          <tr>
            <td><%= formatDate(record.date) %></td>
            <td><%= record.source %></td>
            <td><%= record.description %></td>
            <td>GHS <%= record.amount.toFixed(2) %></td>
            <td>
              <a href="/expenditure/<%= record.id %>/edit" class="btn btn-warning btn-sm">Edit</a>
              <form action="/delete/<%= record.id %>" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this entry?');">
                <button type="submit" class="btn btn-danger btn-sm">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</body>
</html>
